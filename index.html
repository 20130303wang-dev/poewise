<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PoeWise - å®æ—¶æ±‡ç‡ä¸æŠ€èƒ½å®éªŒå®¤</title>
    <style>
        :root { 
            --wise-green: #25d970; 
            --bg: #ffffff; 
            --text-main: #111827; 
            --text-sub: #6b7280; 
            --border: #e5e7eb;
        }
        body { font-family: -apple-system, "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); margin: 0; color: var(--text-main); -webkit-font-smoothing: antialiased; }
        
        /* æ–°å¢ï¼šæ ‡ç­¾åˆ‡æ¢å¯¼èˆª */
        .nav-tabs { display: flex; background: #fff; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 1000; }
        .tab-item { flex: 1; text-align: center; padding: 15px 0; font-size: 15px; font-weight: 700; color: var(--text-sub); cursor: pointer; transition: 0.3s; border-bottom: 2px solid transparent; }
        .tab-item.active { color: var(--wise-green); border-bottom-color: var(--wise-green); }

        /* åŸæœ‰ï¼šHeader æ ·å¼ */
        .header { padding: 40px 20px 20px; text-align: left; max-width: 480px; margin: 0 auto; }
        .header h1 { margin: 0; font-size: 32px; font-weight: 800; }
        .header h1 span { color: var(--wise-green); }
        .header p { color: var(--text-sub); margin-top: 8px; font-size: 15px; }

        .container { max-width: 480px; margin: 0 auto; padding: 0 20px; }
        .content-section { display: none; animation: fadeIn 0.4s ease; }
        .content-section.active { display: block; }

        /* --- æŠ€èƒ½è¿æ‹›å·¥å…·ä¸“å±æ ·å¼ --- */
        .search-wrap { margin: 20px 0; }
        .search-input { width: 100%; padding: 16px; background: #f9fafb; border: 1px solid var(--border); border-radius: 12px; font-size: 16px; outline: none; box-sizing: border-box; }
        .search-input:focus { border-color: var(--wise-green); background: #fff; box-shadow: 0 0 0 4px rgba(37, 217, 112, 0.1); }
        .gem-card { background: #fff; border: 1px solid var(--border); border-radius: 20px; padding: 24px; margin-bottom: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
        .radar-box { background: #f9fafb; border-radius: 16px; padding: 20px 0; margin: 15px 0; text-align: center; }
        .radar-canvas { width: 280px; height: 280px; }
        .synergy-box { background: #f0fff4; border-radius: 14px; padding: 16px; border: 1px solid rgba(37, 217, 112, 0.2); }
        .syn-label { font-size: 12px; color: var(--wise-green); font-weight: 800; margin-bottom: 4px; display: block; }

        /* åŸæœ‰ï¼šå…è´£å£°æ˜ä¸é¡µè„šæ ·å¼ */
        .disclaimer { margin-top: 40px; padding: 20px; border-top: 1px solid var(--border); color: var(--text-sub); font-size: 13px; line-height: 1.6; }
        .footer { text-align: center; padding: 30px 20px; font-size: 13px; color: var(--text-sub); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="nav-tabs">
    <div class="tab-item active" onclick="switchTab('rate', this)">ğŸ’° æ±‡ç‡è®¡ç®—</div>
    <div class="tab-item" onclick="switchTab('gem', this)">âš”ï¸ æŠ€èƒ½è¿æ‹›</div>
</div>

<div id="section-rate" class="content-section active">
    <div class="header">
        <h1>PoeWise <span>Rate</span></h1>
        <p>åŸºäºå®æ—¶æ•°æ®çš„å…¨çƒæ±‡ç‡æ¢ç®—</p>
    </div>
    <div class="container">
        <div style="background:#f9fafb; padding:25px; border-radius:20px; border:1px solid var(--border);">
            <p style="text-align:center; color:var(--text-sub);">æ±‡ç‡è®¡ç®—å™¨æ¨¡å—å·²å°±ç»ª</p>
        </div>
    </div>
</div>

<div id="section-gem" class="content-section">
    <div class="header">
        <h1>PoeWise <span>Catalyst</span></h1>
        <p>é’ˆå¯¹ PoE2 çš„åŠ¨æ€åˆ†æä¸è”åŠ¨æŒ‡å—</p>
    </div>
    <div class="container">
        <div class="search-wrap">
            <input type="text" id="gemSearch" class="search-input" placeholder="è¾“å…¥å®çŸ³åç§° (å¦‚: ç¢éª¨ / Boneshatter)" oninput="handleSearch()">
        </div>
        <div id="gem-results"></div>
    </div>
</div>

<div class="container">
    <div class="disclaimer">
        <strong>å…è´£å£°æ˜ï¼š</strong><br>
        æœ¬å·¥å…·æä¾›çš„æ•°æ®ä»…ä¾›å‚è€ƒã€‚æ±‡ç‡æ•°æ®æ¥æºäºç¬¬ä¸‰æ–¹ APIï¼Œå¯èƒ½å­˜åœ¨å»¶è¿Ÿï¼›æŠ€èƒ½æ•°æ®åŒæ­¥è‡ªç¤¾åŒºæ–‡æ¡£ï¼Œå®é™…æ•ˆæœè¯·ä»¥æ¸¸æˆå†…ä¸ºå‡†ã€‚å¼€å‘è€…ä¸æ‰¿æ‹…å› ä½¿ç”¨æœ¬å·¥å…·é€ æˆçš„ä»»ä½•æŸå¤±ã€‚
    </div>
</div>

<div class="footer">
    &copy; 2026 PoeWise Terminal. All rights reserved.
</div>

<script>
    // æ ‡ç­¾åˆ‡æ¢é€»è¾‘
    function switchTab(type, btn) {
        document.querySelectorAll('.tab-item').forEach(i => i.classList.remove('active'));
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('section-' + type).classList.add('active');
        if(type === 'gem') initGemData();
    }

    // æŠ€èƒ½è¿æ‹›é€»è¾‘ (ä¸ä¹‹å‰ç”Ÿæˆçš„ catalyst_master_db.json é…åˆ)
    let gemData = [];
    async function initGemData() {
        if(gemData.length > 0) return;
        try {
            const response = await fetch('catalyst_master_db.json');
            gemData = await response.json();
        } catch(e) { console.error("æ— æ³•åŠ è½½æŠ€èƒ½æ•°æ®åº“ï¼Œè¯·ç¡®ä¿ JSON æ–‡ä»¶å·²ä¸Šä¼ "); }
    }

    function handleSearch() {
        const query = document.getElementById('gemSearch').value.toLowerCase();
        const resultsWrap = document.getElementById('gem-results');
        resultsWrap.innerHTML = '';
        if(!query) return;

        const matches = gemData.filter(g => g.en.toLowerCase().includes(query) || g.zh.includes(query));
        matches.forEach((gem, idx) => {
            const canvasId = `radar-${idx}`;
            resultsWrap.innerHTML += `
                <div class="gem-card">
                    <span class="badge">${gem.role}</span>
                    <h3 style="margin:0; font-size:22px;">${gem.en}</h3>
                    <p style="color:var(--text-sub); margin:4px 0 15px;">${gem.zh}</p>
                    <p style="font-size:14px; line-height:1.6; border-top:1px solid var(--border); padding-top:12px;">${gem.desc}</p>
                    <div class="radar-box">
                        <canvas id="${canvasId}" width="360" height="360" style="width:260px;height:260px;"></canvas>
                    </div>
                    <div class="synergy-box">
                        <span class="syn-label">âš¡ æœ€ä½³è”åŠ¨</span>
                        <div style="font-weight:700;">${gem.syn}</div>
                    </div>
                </div>
            `;
            setTimeout(() => drawRadar(canvasId, gem.stats), 50);
        });
    }

    // é›·è¾¾å›¾ç»˜åˆ¶é€»è¾‘ (ä¿æŒåŸæœ‰å¤§å°ºå¯¸å’Œæ¸…æ™°æ ‡æ³¨)
    function drawRadar(id, stats) {
        const canvas = document.getElementById(id);
        const ctx = canvas.getContext('2d'), cx = 180, cy = 180, r = 110;
        const labels = ["ä¼¤å®³", "èŒƒå›´", "æœºåŠ¨", "ç‰¹æ•ˆ", "æ‰‹æ„Ÿ"];
        ctx.clearRect(0,0,360,360); ctx.strokeStyle = '#e5e7eb';
        for(let j=1; j<=3; j++){
            ctx.beginPath(); let cr = (r/3)*j;
            for(let i=0; i<5; i++){
                let a = (Math.PI*2/5)*i - Math.PI/2;
                ctx.lineTo(cx+cr*Math.cos(a), cy+cr*Math.sin(a));
            }
            ctx.closePath(); ctx.stroke();
        }
        ctx.font = "bold 14px sans-serif"; ctx.fillStyle = "#6b7280"; ctx.textAlign = "center";
        labels.forEach((l, i) => {
            let a = (Math.PI*2/5)*i - Math.PI/2;
            ctx.fillText(l, cx+(r+40)*Math.cos(a), cy+(r+20)*Math.sin(a));
        });
        ctx.fillStyle = 'rgba(37,217,112,0.2)'; ctx.strokeStyle = '#25d970'; ctx.lineWidth = 4;
        ctx.beginPath();
        stats.forEach((s, i) => {
            let a = (Math.PI*2/5)*i - Math.PI/2;
            ctx.lineTo(cx+(s/100)*r*Math.cos(a), cy+(s/100)*r*Math.sin(a));
        });
        ctx.closePath(); ctx.fill(); ctx.stroke();
    }
</script>
</body>
</html>
