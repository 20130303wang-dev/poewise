<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PoeWise - 实时汇率与技能实验室</title>
    <style>
        :root { 
            --wise-green: #25d970; 
            --bg: #ffffff; 
            --text-main: #111827; 
            --text-sub: #6b7280; 
            --border: #f1f1f1;
        }
        
        body { font-family: -apple-system, "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); margin: 0; color: var(--text-main); -webkit-font-smoothing: antialiased; }
        
        /* 1. 顶部 Tab 导航：找回高级感 */
        .tab-nav { display: flex; background: #fff; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 1000; }
        .tab-btn { flex: 1; text-align: center; padding: 18px 0; font-size: 15px; font-weight: 700; color: var(--text-sub); border: none; background: none; cursor: pointer; transition: 0.3s; position: relative; }
        .tab-btn.active { color: var(--wise-green); }
        .tab-btn.active::after { content: ""; position: absolute; bottom: 0; left: 20%; width: 60%; height: 3px; background: var(--wise-green); border-radius: 2px; }

        /* 2. Header：保持原有的大标题风格 */
        .header { padding: 40px 20px 10px; text-align: left; max-width: 480px; margin: 0 auto; }
        .header h1 { margin: 0; font-size: 32px; font-weight: 800; letter-spacing: -1px; }
        .header h1 span { color: var(--wise-green); }
        .header p { color: var(--text-sub); margin-top: 8px; font-size: 15px; }

        .container { max-width: 480px; margin: 0 auto; padding: 0 20px; }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: slideUp 0.4s ease-out; }

        /* 3. 技能连招：颜值模块 */
        .search-wrap { margin: 25px 0; }
        .search-input { width: 100%; padding: 18px; background: #f9fafb; border: 1px solid var(--border); border-radius: 14px; font-size: 17px; outline: none; box-sizing: border-box; }
        .search-input:focus { border-color: var(--wise-green); background: #fff; box-shadow: 0 0 0 4px rgba(37, 217, 112, 0.1); }

        .gem-card { background: #fff; border: 1px solid var(--border); border-radius: 24px; padding: 26px; margin-bottom: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        .badge { font-size: 11px; font-weight: 800; color: var(--wise-green); background: rgba(37, 217, 112, 0.1); padding: 5px 12px; border-radius: 8px; margin-bottom: 15px; display: inline-block; }
        .en-title { font-size: 24px; font-weight: 900; color: var(--text-main); margin: 0; }
        .zh-title { font-size: 17px; color: var(--text-sub); margin: 4px 0 15px; }

        .radar-box-large { background: #f9fafb; border-radius: 20px; padding: 30px 0; margin: 20px 0; display: flex; flex-direction: column; align-items: center; }
        .radar-canvas { width: 280px; height: 280px; }

        .synergy-box { background: #f0fff4; border-radius: 16px; padding: 18px; border: 1px solid rgba(37, 217, 112, 0.2); }
        .syn-label { font-size: 12px; color: var(--wise-green); font-weight: 800; margin-bottom: 6px; display: block; }

        /* 4. 原有：免责声明与页脚 (直接对齐 indexa.html) */
        .disclaimer-section { border-top: 1px solid var(--border); margin-top: 40px; padding: 30px 20px; background: #fcfcfc; }
        .disclaimer-text { max-width: 480px; margin: 0 auto; font-size: 13px; color: var(--text-sub); line-height: 1.8; }
        .footer { text-align: center; padding: 40px 20px; font-size: 13px; color: var(--text-sub); }

        @keyframes slideUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<nav class="tab-nav">
    <button class="tab-btn active" onclick="switchTab('rate', this)">实时汇率</button>
    <button class="tab-btn" onclick="switchTab('gem', this)">技能连招</button>
</nav>

<div id="tab-rate" class="tab-content active">
    <div class="header"><h1>PoeWise <span>Rate</span></h1><p>全球主流币种实时换算</p></div>
    <div class="container">
        <div style="background:#f9fafb; padding:25px; border-radius:20px; border:1px solid var(--border); margin-top:20px; text-align:center;">
            <p style="color:var(--text-sub);">[ 汇率模块已连接 ]</p>
        </div>
    </div>
</div>

<div id="tab-gem" class="tab-content">
    <div class="header"><h1>PoeWise <span>Catalyst</span></h1><p>全量宝石联动 · 性能分析</p></div>
    <div class="container">
        <div class="search-wrap">
            <input type="text" id="gemSearch" class="search-input" placeholder="输入宝石名称 (如: 碎骨 / Boneshatter)" oninput="handleSearch()">
        </div>
        <div id="gem-results"></div>
    </div>
</div>

<div class="disclaimer-section">
    <div class="disclaimer-text">
        <strong>免责声明：</strong><br>
        本工具提供的数据仅供参考。汇率数据来源于第三方 API，可能存在延迟；技能数据同步自社区文档，实际效果请以游戏内为准。开发者不承担因使用本工具造成的任何损失。
    </div>
</div>

<div class="footer">&copy; 2026 PoeWise Terminal. All rights reserved.</div>

<script>
    function switchTab(type, btn) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + type).classList.add('active');
        if(type === 'gem') loadGemData();
    }

    let gemDatabase = [];
    async function loadGemData() {
        if(gemDatabase.length > 0) return;
        try {
            const res = await fetch('catalyst_master_db.json');
            gemDatabase = await res.json();
        } catch(e) { console.error("JSON 加载失败"); }
    }

    function handleSearch() {
        const query = document.getElementById('gemSearch').value.toLowerCase();
        const results = document.getElementById('gem-results');
        results.innerHTML = '';
        if(!query) return;

        const matches = gemDatabase.filter(g => g.en.toLowerCase().includes(query) || g.zh.includes(query));
        matches.forEach((gem, idx) => {
            const canvasId = `radar-${idx}`;
            results.innerHTML += `
                <div class="gem-card">
                    <span class="badge">${gem.role}</span>
                    <p class="en-title">${gem.en}</p>
                    <p class="zh-title">${gem.zh}</p>
                    <p style="font-size:14px; color:var(--text-sub); border-top:1px solid var(--border); padding-top:15px; line-height:1.7;">${gem.desc}</p>
                    <div class="radar-box-large">
                        <canvas id="${canvasId}" width="360" height="360" style="width:280px;height:280px;"></canvas>
                    </div>
                    <div class="synergy-box">
                        <span class="syn-label">⚡ 最佳连招建议 (BEST SYNERGY)</span>
                        <div style="font-weight:700;">${gem.syn}</div>
                    </div>
                </div>`;
            setTimeout(() => drawRadar(canvasId, gem.stats), 50);
        });
    }

    function drawRadar(id, stats) {
        const canvas = document.getElementById(id);
        const ctx = canvas.getContext('2d'), cx = 180, cy = 180, r = 110;
        const lbls = ["伤害 DMG", "范围 AoE", "机动 MOB", "特效 VIS", "手感 FEEL"];
        ctx.clearRect(0,0,360,360); ctx.strokeStyle = '#e5e7eb';
        for(let j=1; j<=3; j++){
            ctx.beginPath(); let cr=(r/3)*j;
            for(let i=0; i<5; i++){ let a=(Math.PI*2/5)*i-Math.PI/2; ctx.lineTo(cx+cr*Math.cos(a),cy+cr*Math.sin(a)); }
            ctx.closePath(); ctx.stroke();
        }
        ctx.font="bold 14px sans-serif"; ctx.fillStyle="#6b7280"; ctx.textAlign="center";
        lbls.forEach((l,i)=>{ let a=(Math.PI*2/5)*i-Math.PI/2; ctx.fillText(l,cx+(r+45)*Math.cos(a),cy+(r+20)*Math.sin(a)); });
        ctx.fillStyle='rgba(37,217,112,0.25)'; ctx.strokeStyle='#25d970'; ctx.lineWidth=4;
        ctx.beginPath();
        stats.forEach((s,i)=>{ let a=(Math.PI*2/5)*i-Math.PI/2; ctx.lineTo(cx+(s/100)*r*Math.cos(a),cy+(s/100)*r*Math.sin(a)); });
        ctx.closePath(); ctx.fill(); ctx.stroke();
    }
</script>
</body>
</html>
